(this.webpackJsonpdhiwise=this.webpackJsonpdhiwise||[]).push([[260],{2969:function(p,M,e){(function(R,a){p.exports=a()})(this,function(){"use strict";return function(R,a){a.prototype.isSameOrAfter=function(I,D){return this.isSame(I,D)||this.isAfter(I,D)}}})},3860:function(p,M,e){"use strict";e.r(M);var R=e(0),a=e.n(R),I=e(326),D=e.n(I),l=e(45),B=e(381),it=e.n(B),E=e(26),b=e(74),A=e.n(b),N=e(111),rt=e.n(N),x=e(112),H=e.n(x),W=e(5),st=e.n(W),u=e(4),s=e(81),Y=e(94),c=e(11),J=e(262),X=e(184),Q=e(31),y=e(68),K=e(2),G=e(602),V=e(51),$=e(281),j=(f,o,d)=>new Promise((h,O)=>{var v=t=>{try{P(d.next(t))}catch(m){O(m)}},T=t=>{try{P(d.throw(t))}catch(m){O(m)}},P=t=>t.done?h(t.value):Promise.resolve(t.value).then(v,T);P((d=d.apply(f,o)).next())});const z=e(2969);A.a.extend(z);function Z({component:f,path:o,moduleId:d,action:h="VIEW",isOnboardingUrl:O=!1}){var v;const T=Object(E.e)(),P=Object(l.g)(),{userData:t}=Object(Y.a)(),m=Object(E.f)(n=>n.auth.userType||0),w=Object(E.f)(n=>n.auth.expireTrialPlan||!1),_=c.a.get(u.A),k=Object(E.f)(n=>n.auth.userPermission||[]),q=Object(E.f)(n=>n.auth.isWorkspaceDeleted||!1),tt=Object(E.f)(n=>n.auth.defaultRedirectUrl),[et,nt]=Object(Q.b)(),{currentApplicationCode:L,currentApplicationId:at}=et,i=Object(l.h)(),U=new URLSearchParams(i.search),S=U.get("figmaRedirectPage"),{hasFeature:F}=Object(N.useFlagsmith)(),C=F(y.f.FIGMA_PLUGIN_ONBOARDING),ot=()=>{setTimeout(()=>{var n;o.includes(G.a)&&!F((n=y.a[L])==null?void 0:n.REACT_ADMIN_PANEL)&&P.push("*")},0)},lt=()=>j(this,null,function*(){try{yield H.a.identify(t==null?void 0:t.email,{email:t==null?void 0:t.email})}catch(n){console.warn("flagsmith")}ot()});if(a.a.useEffect(()=>j(this,null,function*(){L===K.c.reactAdmin&&(yield lt())}),[t==null?void 0:t.email]),a.a.useEffect(()=>{var n,r;(r=(n=document.getElementsByTagName("flt-glass-pane"))==null?void 0:n[0])!=null&&r.style&&(document.getElementsByTagName("flt-glass-pane")[0].style.display="none")},[o]),Object(W.last)(o.split("/"))===":appId"&&!at)return a.a.createElement(l.a,{to:"/dashboard"});if(L!==K.c.reactAdmin&&o.includes(G.a))return a.a.createElement(l.a,{to:"*"});if(o==="/figma-authentication"&&!_&&c.a.set("FIGMA_PLUGIN_REDIRECTION",(i==null?void 0:i.pathname)+(i==null?void 0:i.search)),o==="/figmaPluginCode"&&!_&&c.a.set("FIGMA_PLUGIN_REDIRECTION",(i==null?void 0:i.pathname)+(i==null?void 0:i.search)),o==="/figmaPluginApp"&&!_&&c.a.set(u.h,(i==null?void 0:i.pathname)+(i==null?void 0:i.search)),o==="/account/figma-list"&&!_&&c.a.set("FIGMA_LIST_REDIRECTION","/account/figma-list"),["/select-screen-app","/template-category-app"].includes(o)&&!_){c.a.set(u.D,i==null?void 0:i.pathname);const n=i.search,r=U.get("ref");(n.includes("utm_source")||n.includes("utm_medium")||n.includes("utm_campaign"))&&c.a.set(u.C,n),r&&c.a.set(u.w,r)}if(!_)return["signin","sign-up"].includes(S)?a.a.createElement(l.a,{to:`/${S}`}):a.a.createElement(l.a,{to:"/sign-up"});c.a.get("TOKEN_EXPIRY")&&A()().isSameOrAfter(A()(c.a.get("TOKEN_EXPIRY")))&&(T({type:"LOGOUT"}),nt(Object(V.d)())),console.log("here, protected route");const g=Object($.a)(U);if(console.log("connectedWithIntelliJUrl",g),o!=="/connected-with-wisegpt"&&(g==null?void 0:g.length))return a.a.createElement(l.a,{to:g});if((t==null?void 0:t._id)&&(t==null?void 0:t.step)&&(t==null?void 0:t.step)<=s.f.FIGMA_PLUGIN_AUTH_REDIRECT.id&&!O){const n=D()(Object.values(s.f),{id:t.step});let r=n!=null&&n.link?n==null?void 0:n.link:"/dashboard";return console.log("condition with < 9"),!n&&s.f.ONBOARDING.id<=(t==null?void 0:t.step)<s.f.SELECT_TECHNOLOGY.id&&(r="/onboarding"),r==="/dashboard"&&(r=tt),(t==null?void 0:t.step)===s.f.FIGMA_PLUGIN_AUTH_REDIRECT.id&&c.a.get("FIGMA_PLUGIN_REDIRECTION")&&(r=c.a.get("FIGMA_PLUGIN_REDIRECTION")),(t==null?void 0:t.step)===s.f.FIGMA_PLUGIN_AUTH_REDIRECT.id&&i.search.includes("figmaPluginCode=true")&&(r=i.pathname+i.search),(t==null?void 0:t.step)===s.f.FIGMA_PLUGIN_AUTH_REDIRECT.id&&r==="/dashboard"&&(r="/onboarding"),C&&o==="/figma-authentication"&&s.f.ONBOARDING.id<=(t==null?void 0:t.step)&&(r="/onboarding"),a.a.createElement(l.a,{to:r})}if(C&&o==="/figma-authentication"&&s.f.ONBOARDING.id<=(t==null?void 0:t.step))return a.a.createElement(l.a,{to:"/onboarding"});if(C&&o==="/figmaPluginApp"&&s.f.ONBOARDING.id<=(t==null?void 0:t.step))return a.a.createElement(l.a,{to:"/onboarding"});if(o==="/onboarding"&&(t==null?void 0:t.step)===s.f.FINAL.id)return a.a.createElement(l.a,{to:"/dashboard"});if((t==null?void 0:t.step)===s.f.SELECT_TECHNOLOGY.id&&!O)return a.a.createElement(l.a,{to:"/onboarding"});if(w&&!s.a.includes(o))return m===s.e.PRIMARY?a.a.createElement(l.a,{to:"/upgrade-your-plan"}):a.a.createElement(l.a,{to:"/developer-plan"});if(d){const n=(v=k.find(r=>r.module===d))==null?void 0:v.actions;if(!n||!n[h])return t!=null&&t._id?a.a.createElement(l.a,{to:"*"}):(localStorage.clear(),a.a.createElement(l.a,{to:"/signIn"}))}return q&&["/new","/technology-step","/technology-select"].includes(o)?a.a.createElement(l.a,{to:"*"}):!!(t!=null&&t._id)&&!!_?(console.log("redect why?",o),a.a.createElement(l.b,{component:f,path:o})):a.a.createElement(l.a,{to:"/sign-up"})}M.default=Object(B.withErrorBoundary)(Z,{FallbackComponent:J.a,onError(f,o){const d={errorLog:f.toString(),componentStack:o==null?void 0:o.componentStack,route:window.location.pathname};Object(X.a)(d)},resetKeys:[Math.random()]})}}]);
